<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Auto Betfair OCR Load Calculator</title>
<script src="https://unpkg.com/tesseract.js@5/dist/tesseract.min.js"></script>
<style>
body{font-family:Arial;background:#0f172a;color:#fff;padding:20px}
h1{text-align:center;color:#38bdf8}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.card{background:#020617;padding:15px;border-radius:10px}
input{width:90%;padding:4px}
table{width:100%;border-collapse:collapse}
td,th{border-bottom:1px solid #1e293b;padding:6px;text-align:center}
.back{background:#cfe8ff;color:#000}
.lay{background:#ffc0cb;color:#000}
button{padding:10px 25px;margin:15px}
.good{color:#22c55e}
.bad{color:#ef4444}
.warn{color:#facc15}
</style>
</head>

<body>

<h1>ðŸ¤– Auto Betfair Screenshot Load Calculator</h1>

<div class="grid">

<div class="card">
<h3>Upload Screenshot â€“ Team A</h3>
<input type="file" accept="image/*" onchange="process(this,'a')">
<p id="status_a"></p>
</div>

<div class="card">
<h3>Upload Screenshot â€“ Team B</h3>
<input type="file" accept="image/*" onchange="process(this,'b')">
<p id="status_b"></p>
</div>

</div>

<br>

<div class="grid">

<div class="card">
<h3>Team A (Auto-Filled)</h3>
<table>
<tr><th>Type</th><th>Odds</th><th>Amount</th></tr>
<tr><td class="back">Back</td><td><input id="a_bo1"></td><td><input id="a_ba1"></td></tr>
<tr><td class="back">Back</td><td><input id="a_bo2"></td><td><input id="a_ba2"></td></tr>
<tr><td class="back">Back</td><td><input id="a_bo3"></td><td><input id="a_ba3"></td></tr>
<tr><td class="lay">Lay</td><td><input id="a_lo1"></td><td><input id="a_la1"></td></tr>
<tr><td class="lay">Lay</td><td><input id="a_lo2"></td><td><input id="a_la2"></td></tr>
<tr><td class="lay">Lay</td><td><input id="a_lo3"></td><td><input id="a_la3"></td></tr>
</table>
</div>

<div class="card">
<h3>Team B (Auto-Filled)</h3>
<table>
<tr><th>Type</th><th>Odds</th><th>Amount</th></tr>
<tr><td class="back">Back</td><td><input id="b_bo1"></td><td><input id="b_ba1"></td></tr>
<tr><td class="back">Back</td><td><input id="b_bo2"></td><td><input id="b_ba2"></td></tr>
<tr><td class="back">Back</td><td><input id="b_bo3"></td><td><input id="b_ba3"></td></tr>
<tr><td class="lay">Lay</td><td><input id="b_lo1"></td><td><input id="b_la1"></td></tr>
<tr><td class="lay">Lay</td><td><input id="b_lo2"></td><td><input id="b_la2"></td></tr>
<tr><td class="lay">Lay</td><td><input id="b_lo3"></td><td><input id="b_la3"></td></tr>
</table>
</div>

</div>

<button onclick="calculate()">CALCULATE LOAD</button>

<div class="card" id="result"></div>

<script>
function process(input,p){
 let status=document.getElementById("status_"+p);
 status.innerText="Reading screenshot...";
 Tesseract.recognize(input.files[0],'eng').then(({data:{text}})=>{
   let odds=[...text.matchAll(/\b[1-9]\.\d{2}\b/g)].map(x=>x[0]);
   let amt=[...text.matchAll(/\Â£?\d{1,3}(,\d{3})*(\.\d+)?/g)]
            .map(x=>x[0].replace(/Â£|,/g,''));
   for(let i=0;i<3;i++){
     document.getElementById(p+"_bo"+(i+1)).value=odds[i]||"";
     document.getElementById(p+"_ba"+(i+1)).value=amt[i]||"";
     document.getElementById(p+"_lo"+(i+1)).value=odds[i+3]||"";
     document.getElementById(p+"_la"+(i+1)).value=amt[i+3]||"";
   }
   status.innerText="Auto-fill done âœ” (verify once)";
 });
}

function v(id){return Number(document.getElementById(id).value)||0}

function load(p){
 let back=v(p+"ba1")+v(p+"ba2")+v(p+"ba3");
 let lay=v(p+"la1")*(v(p+"lo1")-1)+v(p+"la2")*(v(p+"lo2")-1)+v(p+"la3")*(v(p+"lo3")-1);
 return back-lay;
}

function calculate(){
 let A=load("a_"),B=load("b_");
 let t=Math.abs(A)+Math.abs(B);
 let sig="âš ï¸ FAKE / MIXED";
 if(A>0&&B<0) sig="âœ… REAL MOVE â†’ Team A";
 if(B>0&&A<0) sig="âœ… REAL MOVE â†’ Team B";
 document.getElementById("result").innerHTML=`
 <h3>RESULT</h3>
 Team A Load: <b class="${A>0?'good':'bad'}">Â£${A.toFixed(2)}</b><br>
 Team B Load: <b class="${B>0?'good':'bad'}">Â£${B.toFixed(2)}</b><br>
 <h3 class="warn">${sig}</h3>`;
}
</script>

</body>
</html>
